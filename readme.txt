It does a topological sort in lexicographical manner.
The graph must be acyclic and directed. 